<!DOCTYPE html>



  


<html class="theme-next pisces use-motion" lang="zh-Hans">
<head>
  <meta charset="UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=edge" />
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1"/>
<meta name="theme-color" content="#222">
<script src="//cdn.bootcss.com/pace/1.0.2/pace.min.js"></script>
<link href="//cdn.bootcss.com/pace/1.0.2/themes/pink/pace-theme-flash.css" rel="stylesheet">
<script>
    (function(){
        if(''){
            if (prompt('请输入文章密码') !== ''){
                alert('密码错误！');
                history.back();
            }
        }
    })();
</script>

<style>
    .pace .pace-progress {
        background: #1E92FB; /*进度条颜色*/
        height: 3px;
    }
    .pace .pace-progress-inner {
         box-shadow: 0 0 10px #1E92FB, 0 0 5px     #1E92FB; /*阴影颜色*/
    }
    .pace .pace-activity {
        border-top-color: #1E92FB;    /*上边框颜色*/
        border-left-color: #1E92FB;    /*左边框颜色*/
    }
</style>



  
  
    
    
  <script src="/lib/pace/pace.min.js?v=1.0.2"></script>
  <link href="/lib/pace/pace-theme-minimal.min.css?v=1.0.2" rel="stylesheet">







<meta http-equiv="Cache-Control" content="no-transform" />
<meta http-equiv="Cache-Control" content="no-siteapp" />















  
  
  <link href="/lib/fancybox/source/jquery.fancybox.css?v=2.1.5" rel="stylesheet" type="text/css" />




  
  
  
  

  
    
    
  

  
    
      
    

    
  

  

  

  
    
      
    

    
  

  
    
    
    <link href="https://fonts.cat.net/css?family=Lato:300,300italic,400,400italic,700,700italic|Roboto Slab:300,300italic,400,400italic,700,700italic|Roboto Slab:300,300italic,400,400italic,700,700italic&subset=latin,latin-ext" rel="stylesheet" type="text/css">
  






<link href="/lib/font-awesome/css/font-awesome.min.css?v=4.6.2" rel="stylesheet" type="text/css" />

<link href="/css/main.css?v=5.1.2" rel="stylesheet" type="text/css" />


  <meta name="keywords" content="dubbo," />








  <link rel="shortcut icon" type="image/x-icon" href="/favicon.ico?v=5.1.2" />






<meta name="description" content="Dubbo框架学习 概念 Dubbo是一个分布式服务框架，致力于提供高性能和透明化的RPC远程服务调用方案，以及SOA服务治理。 分布式系统是若干独立计算机的集合，这些计算机对于用户来说就像单个相关系统。 分布式系统（distributed system）是建立在网络之上的软件系统。 随着互联网的发展，网站应用的规模不断扩大，常规的垂直应用架构已无法应对，分布式服务架构以及流动计算架构势在必行，亟">
<meta name="keywords" content="dubbo">
<meta property="og:type" content="article">
<meta property="og:title" content="Dubbo框架学习">
<meta property="og:url" content="https://inurou.github.io/2018/10/09/Dubbo框架学习/index.html">
<meta property="og:site_name" content="嗨，这里是inu的博客地址，欢迎您的到来~~~">
<meta property="og:description" content="Dubbo框架学习 概念 Dubbo是一个分布式服务框架，致力于提供高性能和透明化的RPC远程服务调用方案，以及SOA服务治理。 分布式系统是若干独立计算机的集合，这些计算机对于用户来说就像单个相关系统。 分布式系统（distributed system）是建立在网络之上的软件系统。 随着互联网的发展，网站应用的规模不断扩大，常规的垂直应用架构已无法应对，分布式服务架构以及流动计算架构势在必行，亟">
<meta property="og:locale" content="zh-Hans">
<meta property="og:image" content="https://i.imgur.com/IAvnriJ.png">
<meta property="og:image" content="https://i.imgur.com/dDVK4K0.png">
<meta property="og:image" content="https://i.imgur.com/fVrf7NQ.png">
<meta property="og:image" content="https://i.imgur.com/GLXkrjI.png">
<meta property="og:image" content="https://i.imgur.com/Unzhn73.png">
<meta property="og:image" content="https://i.imgur.com/pxhatpA.png">
<meta property="og:image" content="https://i.imgur.com/eNQK8zY.png">
<meta property="og:image" content="https://i.imgur.com/ogwGuju.png">
<meta property="og:image" content="https://i.imgur.com/7uHZYS6.png">
<meta property="og:image" content="https://i.imgur.com/sspnQBW.png">
<meta property="og:image" content="https://i.imgur.com/TTqLWB5.png">
<meta property="og:image" content="https://i.imgur.com/h6F1Xnx.png">
<meta property="og:image" content="https://i.imgur.com/o4SM4Vb.png">
<meta property="og:image" content="https://i.imgur.com/V6v8O1Y.png">
<meta property="og:image" content="https://i.imgur.com/OF6SruQ.png">
<meta property="og:image" content="https://i.imgur.com/6Cfdcpf.png">
<meta property="og:image" content="https://i.imgur.com/bd6YdAm.png">
<meta property="og:image" content="https://i.imgur.com/Y5srf7w.png">
<meta property="og:image" content="https://i.imgur.com/sCBHDGm.png">
<meta property="og:image" content="https://i.imgur.com/9eLIW6n.png">
<meta property="og:image" content="https://i.imgur.com/xsyB7FO.png">
<meta property="og:image" content="https://i.imgur.com/2SqWPHl.png">
<meta property="og:image" content="https://i.imgur.com/mLmlHKT.png">
<meta property="og:image" content="https://i.imgur.com/44L9Da7.png">
<meta property="og:image" content="https://i.imgur.com/MFfN9AF.png">
<meta property="og:image" content="https://i.imgur.com/0ORz7ii.png">
<meta property="og:image" content="https://i.imgur.com/SBm6dvs.png">
<meta property="og:image" content="https://i.imgur.com/9sYbjet.png">
<meta property="og:image" content="https://i.imgur.com/d1tPI3m.png">
<meta property="og:image" content="https://i.imgur.com/meGpOyY.png">
<meta property="og:image" content="https://i.imgur.com/0cDzlpZ.png">
<meta property="og:image" content="https://i.imgur.com/dYHEYur.png">
<meta property="og:image" content="https://i.imgur.com/UyTluWr.png">
<meta property="og:image" content="https://i.imgur.com/XwqpFp9.png">
<meta property="og:image" content="https://i.imgur.com/OoJriEb.png">
<meta property="og:image" content="https://i.imgur.com/EDrrPes.png">
<meta property="og:image" content="https://i.imgur.com/yMwo7Bc.png">
<meta property="og:image" content="https://i.imgur.com/9p9sFVH.png">
<meta property="og:image" content="https://i.imgur.com/Z1omkkw.png">
<meta property="og:image" content="https://i.imgur.com/rt3YVYn.png">
<meta property="og:image" content="https://i.imgur.com/1daJBV5.png">
<meta property="og:image" content="https://i.imgur.com/nDqoHe1.png">
<meta property="og:updated_time" content="2018-10-09T12:14:48.200Z">
<meta name="twitter:card" content="summary">
<meta name="twitter:title" content="Dubbo框架学习">
<meta name="twitter:description" content="Dubbo框架学习 概念 Dubbo是一个分布式服务框架，致力于提供高性能和透明化的RPC远程服务调用方案，以及SOA服务治理。 分布式系统是若干独立计算机的集合，这些计算机对于用户来说就像单个相关系统。 分布式系统（distributed system）是建立在网络之上的软件系统。 随着互联网的发展，网站应用的规模不断扩大，常规的垂直应用架构已无法应对，分布式服务架构以及流动计算架构势在必行，亟">
<meta name="twitter:image" content="https://i.imgur.com/IAvnriJ.png">



<script type="text/javascript" id="hexo.configurations">
  var NexT = window.NexT || {};
  var CONFIG = {
    root: '/',
    scheme: 'Pisces',
    sidebar: {"position":"left","display":"post","offset":12,"offset_float":12,"b2t":false,"scrollpercent":false,"onmobile":false},
    fancybox: true,
    tabs: true,
    motion: true,
    duoshuo: {
      userId: '0',
      author: '博主'
    },
    algolia: {
      applicationID: '',
      apiKey: '',
      indexName: '',
      hits: {"per_page":10},
      labels: {"input_placeholder":"Search for Posts","hits_empty":"We didn't find any results for the search: ${query}","hits_stats":"${hits} results found in ${time} ms"}
    }
  };
</script>



  <link rel="canonical" href="https://inurou.github.io/2018/10/09/Dubbo框架学习/"/>





  <title>Dubbo框架学习 | 嗨，这里是inu的博客地址，欢迎您的到来~~~</title>
  














</head>

<body itemscope itemtype="http://schema.org/WebPage" lang="zh-Hans">

  
  
    
  

  <div class="container sidebar-position-left page-post-detail ">
    <div class="headband"></div>
	<header id="header" class="header" itemscope itemtype="http://schema.org/WPHeader">
      <div class="header-inner"><div class="site-brand-wrapper">
  <div class="site-meta ">
    

    <div class="custom-logo-site-title">
      <a href="/"  class="brand" rel="start">
        <span class="logo-line-before"><i></i></span>
        <span class="site-title">嗨，这里是inu的博客地址，欢迎您的到来~~~</span>
        <span class="logo-line-after"><i></i></span>
      </a>
    </div>
      
        <p class="site-subtitle">扬帆，启航</p>
      
  </div>

  <div class="site-nav-toggle">
    <button>
      <span class="btn-bar"></span>
      <span class="btn-bar"></span>
      <span class="btn-bar"></span>
    </button>
  </div>
</div>

<nav class="site-nav">
  

  
    <ul id="menu" class="menu">
      
        
        <li class="menu-item menu-item-home">
          <a href="/" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-home"></i> <br />
            
            首页
          </a>
        </li>
      
        
        <li class="menu-item menu-item-categories">
          <a href="/categories" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-th"></i> <br />
            
            分类
          </a>
        </li>
      
        
        <li class="menu-item menu-item-archives">
          <a href="/archives" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-archive"></i> <br />
            
            归档
          </a>
        </li>
      
        
        <li class="menu-item menu-item-tags">
          <a href="/tags" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-tags"></i> <br />
            
            标签
          </a>
        </li>
      

      
    </ul>
  

  
</nav>



 </div>
    </header>

    <main id="main" class="main">
      <div class="main-inner">
        <div class="content-wrap">
          <div id="content" class="content">
            

  <div id="posts" class="posts-expand">
    

  

  
  
  

  <article class="post post-type-normal" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="https://inurou.github.io/2018/10/09/Dubbo框架学习/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="inu">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="/uploads/avatar.jpg">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="嗨，这里是inu的博客地址，欢迎您的到来~~~">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">Dubbo框架学习</h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">发表于</span>
              
              <time title="创建于" itemprop="dateCreated datePublished" datetime="2018-10-09T20:12:31+08:00">
                2018-10-09
              </time>
            

            

            
          </span>

          
            <span class="post-category" >
            
              <span class="post-meta-divider">|</span>
            
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              
                <span class="post-meta-item-text">分类于</span>
              
              
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/技术/" itemprop="url" rel="index">
                    <span itemprop="name">技术</span>
                  </a>
                </span>

                
                
              
            </span>
          

          
            
          

          
          

          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        <h1 id="Dubbo框架学习"><a href="#Dubbo框架学习" class="headerlink" title="Dubbo框架学习"></a>Dubbo框架学习</h1><hr>
<h2 id="概念"><a href="#概念" class="headerlink" title="概念"></a>概念</h2><ul>
<li>Dubbo是一个分布式服务框架，致力于提供高性能和透明化的RPC远程服务调用方案，以及SOA服务治理。</li>
<li>分布式系统是若干独立计算机的集合，这些计算机对于用户来说就像单个相关系统。</li>
<li>分布式系统（distributed system）是建立在网络之上的软件系统。</li>
<li>随着互联网的发展，网站应用的规模不断扩大，常规的垂直应用架构已无法应对，分布式服务架构以及流动计算架构势在必行，亟需一个治理系统确保架构有条不紊的演进。</li>
</ul>
<h2 id="发展演变"><a href="#发展演变" class="headerlink" title="发展演变"></a>发展演变</h2><p><img src="https://i.imgur.com/IAvnriJ.png" alt=""></p>
<h3 id="单一应用架构"><a href="#单一应用架构" class="headerlink" title="单一应用架构"></a><em>单一应用架构</em></h3><ul>
<li>当网站流量很小时，只需一个应用，将所有功能都部署在一起，以减少部署节点和成本。此时，用于简化增删改查工作量的数据访问框架(ORM)是关键。</li>
</ul>
<p><img src="https://i.imgur.com/dDVK4K0.png" alt=""></p>
<ul>
<li>适用于小型网站，小型管理系统，将所有功能都部署到一个功能里，简单易用。</li>
<li>缺点： </li>
</ul>
<ol>
<li>性能扩展比较难 </li>
<li>协同开发问题</li>
<li>不利于升级维护</li>
</ol>
<h3 id="垂直应用架构"><a href="#垂直应用架构" class="headerlink" title="垂直应用架构"></a><em>垂直应用架构</em></h3><p><img src="https://i.imgur.com/fVrf7NQ.png" alt=""></p>
<ul>
<li>通过切分业务来实现各个模块独立部署，降低了维护和部署的难度，团队各司其职更易管理，性能扩展也更方便，更有针对性。</li>
<li>缺点： 公用模块无法重复利用，开发性的浪费</li>
</ul>
<h3 id="分布式服务架构"><a href="#分布式服务架构" class="headerlink" title="分布式服务架构"></a><em>分布式服务架构</em></h3><ul>
<li>当垂直应用越来越多，应用之间交互不可避免，将核心业务抽取出来，作为独立的服务，逐渐形成稳定的服务中心，使前端应用能更快速的响应多变的市场需求。此时，用于提高业务复用及整合的分布式服务框架(RPC)是关键。</li>
</ul>
<p><img src="https://i.imgur.com/GLXkrjI.png" alt=""></p>
<h3 id="流动计算架构"><a href="#流动计算架构" class="headerlink" title="流动计算架构"></a><em>流动计算架构</em></h3><p><img src="https://i.imgur.com/Unzhn73.png" alt=""></p>
<ul>
<li>当服务越来越多，容量的评估，小服务资源的浪费等问题逐渐显现，此时需增加一个调度中心基于访问压力实时管理集群容量，提高集群利用率。此时，用于提高机器利用率的资源调度和治理中心(SOA)[ Service Oriented Architecture]是关键。</li>
</ul>
<h2 id="RPC"><a href="#RPC" class="headerlink" title="RPC"></a>RPC</h2><ul>
<li>RPC【Remote Procedure Call】是指远程过程调用，是一种进程间通信方式，他是一种技术的思想，而不是规范。它允许程序调用另一个地址空间（通常是共享网络的另一台机器上）的过程或函数，而不用程序员显式编码这个远程调用的细节。即程序员无论是调用本地的还是远程的函数，本质上编写的调用代码基本相同。</li>
</ul>
<h3 id="基本原理"><a href="#基本原理" class="headerlink" title="基本原理"></a>基本原理</h3><p><img src="https://i.imgur.com/pxhatpA.png" alt=""></p>
<p><img src="https://i.imgur.com/eNQK8zY.png" alt=""></p>
<ul>
<li>RPC两个核心模块：通讯，序列化。</li>
</ul>
<h2 id="Dubbo核心概念"><a href="#Dubbo核心概念" class="headerlink" title="Dubbo核心概念"></a>Dubbo核心概念</h2><h3 id="简介"><a href="#简介" class="headerlink" title="简介"></a>简介</h3><ul>
<li>Apache Dubbo (incubating) |ˈdʌbəʊ| 是一款高性能、轻量级的开源Java RPC框架，它提供了三大核心能力：面向接口的远程方法调用，智能容错和负载均衡，以及服务自动注册和发现。</li>
<li>官网： <a href="http://dubbo.apache.org/" target="_blank" rel="noopener">http://dubbo.apache.org/</a></li>
</ul>
<h3 id="基本概念"><a href="#基本概念" class="headerlink" title="基本概念"></a>基本概念</h3><p><img src="https://i.imgur.com/ogwGuju.png" alt=""></p>
<ul>
<li>服务提供者（Provider）：暴露服务的服务提供方，服务提供者在启动时，向注册中心注册自己提供的服务。</li>
<li>服务消费者（Consumer）: 调用远程服务的服务消费方，服务消费者在启动时，向注册中心订阅自己所需的服务，服务消费者，从提供者地址列表中，基于软负载均衡算法，选一台提供者进行调用，如果调用失败，再选另一台调用。</li>
<li>注册中心（Registry）：注册中心返回服务提供者地址列表给消费者，如果有变更，注册中心将基于长连接推送变更数据给消费者</li>
<li>监控中心（Monitor）：服务消费者和提供者，在内存中累计调用次数和调用时间，定时每分钟发送一次统计数据到监控中心</li>
</ul>
<h4 id="调用关系说明："><a href="#调用关系说明：" class="headerlink" title="调用关系说明："></a>调用关系说明：</h4><ul>
<li>服务容器负责启动，加载，运行服务提供者。</li>
<li>服务提供者在启动时，向注册中心注册自己提供的服务。</li>
<li>服务消费者在启动时，向注册中心订阅自己所需的服务。</li>
<li>注册中心返回服务提供者地址列表给消费者，如果有变更，注册中心将基于长连接推送变更数据给消费者。</li>
<li>服务消费者，从提供者地址列表中，基于软负载均衡算法，选一台提供者进行调用，如果调用失败，再选另一台调用。</li>
<li>服务消费者和提供者，在内存中累计调用次数和调用时间，定时每分钟发送一次统计数据到监控中心。</li>
</ul>
<h2 id="dubbo环境搭建"><a href="#dubbo环境搭建" class="headerlink" title="dubbo环境搭建"></a>dubbo环境搭建</h2><h3 id="windows下安装zookeeper"><a href="#windows下安装zookeeper" class="headerlink" title="windows下安装zookeeper"></a>windows下安装zookeeper</h3><ul>
<li>下载zookeeper<a href="https://archive.apache.org/dist/zookeeper/zookeeper-3.4.13/" target="_blank" rel="noopener">https://archive.apache.org/dist/zookeeper/zookeeper-3.4.13/ </a></li>
<li>解压运行zkServer.cmd ，初次运行会报错，没有zoo.cfg配置文件</li>
<li>将conf下的zoo_sample.cfg复制一份改名为zoo.cfg即可。<br>注意几个重要位置：<br>1、dataDir=./   临时数据存储的目录（可写相对路径）<br>2、clientPort=2181   zookeeper的端口号<br>3、修改完成后再次启动zookeeper</li>
<li>1、ls /：列出zookeeper根下保存的所有节点 2、create –e /atguigu 123：创建一个atguigu节点，值为123<br>3、get /atguigu：获取/atguigu节点的值</li>
</ul>
<h3 id="Windows安装dubbo-admin管理控制台"><a href="#Windows安装dubbo-admin管理控制台" class="headerlink" title="Windows安装dubbo-admin管理控制台"></a>Windows安装dubbo-admin管理控制台</h3><ul>
<li><p>dubbo本身并不是一个服务软件。它其实就是一个jar包能够帮你的java程序连接到zookeeper，并利用zookeeper消费、提供服务。所以你不用在Linux上启动什么dubbo服务。但是为了让用户更好的管理监控众多的dubbo服务，官方提供了一个可视化的监控程序，不过这个监控即使不装也不影响使用。</p>
</li>
<li><p>下载dubbo-admin <a href="https://github.com/apache/incubator-dubbo-ops" target="_blank" rel="noopener">https://github.com/apache/incubator-dubbo-ops </a><br><img src="https://i.imgur.com/7uHZYS6.png" alt=""></p>
</li>
<li><p>修改 src\main\resources\application.properties 指定zookeeper地址</p>
</li>
</ul>
<p><img src="https://i.imgur.com/sspnQBW.png" alt=""></p>
<ul>
<li>打包dubbo-admin 运行：mvn clean package -Dmaven.test.skip=true</li>
<li>运行 java -jar dubbo-admin-0.0.1-SNAPSHOT.jar </li>
<li>访问7001端口默认使用root/root登录</li>
</ul>
<h2 id="dubbo项目实例"><a href="#dubbo项目实例" class="headerlink" title="dubbo项目实例"></a>dubbo项目实例</h2><h3 id="提出需求"><a href="#提出需求" class="headerlink" title="提出需求"></a>提出需求</h3><ul>
<li>某个电商系统，订单服务需要调用用户服务获取某个用户的所有地址</li>
<li>订单服务web模块：创建订单等</li>
<li>用户服务service模块：查询用户模块</li>
<li>测试预期结果：订单服务web模块在A服务器，用户服务模块在B服务器，A可以远程调用B的功能。</li>
</ul>
<h3 id="工程架构"><a href="#工程架构" class="headerlink" title="工程架构"></a>工程架构</h3><h4 id="分包"><a href="#分包" class="headerlink" title="分包"></a>分包</h4><ul>
<li>建议将服务接口，服务模型，服务异常等均放在 API 包中，因为服务模型及异常也是 API 的一部分，同时，这样做也符合分包原则：重用发布等价原则(REP)，共同重用原则(CRP)。</li>
<li>如果需要，也可以考虑在 API 包中放置一份 spring 的引用配置，这样使用方，只需在 spring 加载过程中引用此配置即可，配置建议放在模块的包目录下，以免冲突，如：com/alibaba/china/xxx/dubbo-reference.xml</li>
</ul>
<h4 id="粒度"><a href="#粒度" class="headerlink" title="粒度"></a>粒度</h4><ul>
<li>服务接口尽可能大粒度，每个服务方法应代表一个功能，而不是某功能的一个步骤，否则将面临分布式事务问题，Dubbo 暂未提供分布式事务支持。</li>
<li>服务接口建议以业务场景为单位划分，并对相近业务做抽象，防止接口数量爆炸。</li>
<li>不建议使用过于抽象的通用接口，如：Map query(Map)，这样的接口没有明确语义，会给后期维护带来不便。</li>
</ul>
<h3 id="创建模块"><a href="#创建模块" class="headerlink" title="创建模块"></a>创建模块</h3><h4 id="1、gmall-interface：公共接口层（model，service，exception…）"><a href="#1、gmall-interface：公共接口层（model，service，exception…）" class="headerlink" title="1、gmall-interface：公共接口层（model，service，exception…）"></a>1、gmall-interface：公共接口层（model，service，exception…）</h4><ul>
<li>作用：定义公共接口，也可以导入公共依赖</li>
<li>Bean模型（model）</li>
</ul>
<pre><code> public class UserAddress implements Serializable{
    private Integer id;
    private String userAddress;
    private String userId;
    private String consignee;
    private String phoneNum;
    private String isDefault;
}
</code></pre><ul>
<li><p>service接口</p>
<p>  UserService</p>
<p>  public List<useraddress> getUserAddressList(String userId)</useraddress></p>
</li>
</ul>
<p><img src="https://i.imgur.com/TTqLWB5.png" alt=""></p>
<h4 id="2、gmall-user：用户模块（对用户接口的实现）"><a href="#2、gmall-user：用户模块（对用户接口的实现）" class="headerlink" title="2、gmall-user：用户模块（对用户接口的实现）"></a>2、gmall-user：用户模块（对用户接口的实现）</h4><p><img src="https://i.imgur.com/h6F1Xnx.png" alt=""></p>
<h4 id="3、gmall-order-web：订单模块（调用用户模块）"><a href="#3、gmall-order-web：订单模块（调用用户模块）" class="headerlink" title="3、gmall-order-web：订单模块（调用用户模块）"></a>3、gmall-order-web：订单模块（调用用户模块）</h4><p><img src="https://i.imgur.com/o4SM4Vb.png" alt=""></p>
<ul>
<li>现在这样是无法进行调用的。我们gmall-order-web引入了gmall-interface，但是interface的实现是gmall-user，我们并没有引入，而且实际他可能还在别的服务器中。</li>
</ul>
<h3 id="使用dubbo改造"><a href="#使用dubbo改造" class="headerlink" title="使用dubbo改造"></a>使用dubbo改造</h3><h4 id="1、改造gmall-user作为服务提供者"><a href="#1、改造gmall-user作为服务提供者" class="headerlink" title="1、改造gmall-user作为服务提供者"></a>1、改造gmall-user作为服务提供者</h4><p><img src="https://i.imgur.com/V6v8O1Y.png" alt=""></p>
<p><img src="https://i.imgur.com/OF6SruQ.png" alt=""></p>
<h4 id="2、改造gmall-order-web作为服务消费者"><a href="#2、改造gmall-order-web作为服务消费者" class="headerlink" title="2、改造gmall-order-web作为服务消费者"></a>2、改造gmall-order-web作为服务消费者</h4><p><img src="https://i.imgur.com/6Cfdcpf.png" alt=""></p>
<p><img src="https://i.imgur.com/bd6YdAm.png" alt=""></p>
<h3 id="3、测试调用"><a href="#3、测试调用" class="headerlink" title="3、测试调用"></a>3、测试调用</h3><ul>
<li>访问gmall-order-web的initOrder请求，会调用UserService获取用户地址；</li>
<li>调用成功。说明我们order已经可以调用远程的UserService了；</li>
</ul>
<h3 id="4、注解版"><a href="#4、注解版" class="headerlink" title="4、注解版"></a>4、注解版</h3><p><img src="https://i.imgur.com/Y5srf7w.png" alt=""></p>
<h2 id="监控中心"><a href="#监控中心" class="headerlink" title="监控中心"></a>监控中心</h2><h3 id="dubbo-admin"><a href="#dubbo-admin" class="headerlink" title="dubbo-admin"></a>dubbo-admin</h3><ul>
<li>图形化的服务管理页面；安装时需要指定注册中心地址，即可从注册中心中获取到所有的提供者/消费者进行配置管理</li>
</ul>
<h3 id="dubbo-monitor-simple"><a href="#dubbo-monitor-simple" class="headerlink" title="dubbo-monitor-simple"></a>dubbo-monitor-simple</h3><ul>
<li><p>简单的监控中心；</p>
<h4 id="1、安装"><a href="#1、安装" class="headerlink" title="1、安装"></a>1、安装</h4></li>
<li><p>下载dubbo-ops: <a href="https://github.com/apache/incubator-dubbo-ops" target="_blank" rel="noopener">https://github.com/apache/incubator-dubbo-ops</a></p>
</li>
<li><p>修改配置指定注册中心地址 进入 dubbo-monitor-simple\src\main\resources\conf 修改 dubbo.properties文件</p>
</li>
</ul>
<p><img src="https://i.imgur.com/sCBHDGm.png" alt=""></p>
<ul>
<li>打包dubbo-monitor-simple  命令： mvn clean package -Dmaven.test.skip=true</li>
<li>解压 tar.gz 文件，并运行start.bat</li>
</ul>
<p><img src="https://i.imgur.com/9eLIW6n.png" alt=""></p>
<ul>
<li><p>如果缺少servlet-api，自行导入servlet-api再访问监控中心</p>
</li>
<li><p>启动访问8080</p>
</li>
</ul>
<p><img src="https://i.imgur.com/xsyB7FO.png" alt=""></p>
<h3 id="监控中心配置"><a href="#监控中心配置" class="headerlink" title="监控中心配置"></a>监控中心配置</h3><p><img src="https://i.imgur.com/2SqWPHl.png" alt=""></p>
<ul>
<li>Simple Monitor 挂掉不会影响到 Consumer 和 Provider 之间的调用，所以用于生产环境不会有风险。</li>
<li>Simple Monitor 采用磁盘存储统计信息，请注意安装机器的磁盘限制，如果要集群，建议用mount共享磁盘。</li>
</ul>
<h2 id="整合SpringBoot"><a href="#整合SpringBoot" class="headerlink" title="整合SpringBoot"></a>整合SpringBoot</h2><h3 id="1、引入spring-boot-starter以及dubbo和curator的依赖"><a href="#1、引入spring-boot-starter以及dubbo和curator的依赖" class="headerlink" title="1、引入spring-boot-starter以及dubbo和curator的依赖"></a>1、引入spring-boot-starter以及dubbo和curator的依赖</h3><p><img src="https://i.imgur.com/mLmlHKT.png" alt=""></p>
<h3 id="2、配置application-properties"><a href="#2、配置application-properties" class="headerlink" title="2、配置application.properties"></a>2、配置application.properties</h3><ul>
<li>提供者配置：</li>
</ul>
<p>dubbo.application.name=gmall-user</p>
<p>dubbo.registry.protocol=zookeeper</p>
<p>dubbo.registry.address=192.168.67.159:2181</p>
<p>dubbo.scan.base-package=com.atguigu.gmall</p>
<p>dubbo.protocol.name=dubbo</p>
<p>application.name就是服务名，不能跟别的dubbo提供端重复</p>
<p>registry.protocol 是指定注册中心协议</p>
<p>registry.address 是注册中心的地址加端口号</p>
<p>protocol.name 是分布式固定是dubbo,不要改。</p>
<p>base-package  注解方式要扫描的包</p>
<ul>
<li>消费者配置：</li>
</ul>
<p>dubbo.application.name=gmall-order-web</p>
<p>dubbo.registry.protocol=zookeeper</p>
<p>dubbo.registry.address=192.168.67.159:2181</p>
<p>dubbo.scan.base-package=com.atguigu.gmall</p>
<p>dubbo.protocol.name=dubbo</p>
<ul>
<li>dubbo注解：</li>
</ul>
<p>@Service、@Reference</p>
<p>【如果没有在配置中写dubbo.scan.base-package,还需要使用@EnableDubbo注解】</p>
<h2 id="dubbo配置"><a href="#dubbo配置" class="headerlink" title="dubbo配置"></a>dubbo配置</h2><h3 id="配置原则"><a href="#配置原则" class="headerlink" title="配置原则"></a>配置原则</h3><p><img src="https://i.imgur.com/44L9Da7.png" alt=""></p>
<ul>
<li>JVM 启动 -D 参数优先，这样可以使用户在部署和启动时进行参数重写，比如在启动时需改变协议的端口。</li>
<li>XML 次之，如果在 XML 中有配置，则 dubbo.properties 中的相应配置项无效。</li>
<li>Properties 最后，相当于缺省值，只有 XML 没有配置时，dubbo.properties 的相应配置项才会生效，通常用于共享公共配置，比如应用名。</li>
</ul>
<h3 id="重试次数"><a href="#重试次数" class="headerlink" title="重试次数"></a>重试次数</h3><ul>
<li>失败自动切换，当出现失败，重试其它服务器，但重试会带来更长延迟。可通过 retries=”2” 来设置重试次数(不含第一次)。</li>
</ul>
<p><img src="https://i.imgur.com/MFfN9AF.png" alt=""></p>
<h3 id="超时时间"><a href="#超时时间" class="headerlink" title="超时时间"></a>超时时间</h3><ul>
<li>由于网络或服务端不可靠，会导致调用出现一种不确定的中间状态（超时）。为了避免超时导致客户端资源（线程）挂起耗尽，必须设置超时时间。</li>
</ul>
<h4 id="1、Dubbo消费端"><a href="#1、Dubbo消费端" class="headerlink" title="1、Dubbo消费端"></a>1、Dubbo消费端</h4><p><img src="https://i.imgur.com/0ORz7ii.png" alt=""></p>
<h4 id="2、Dubbo服务端"><a href="#2、Dubbo服务端" class="headerlink" title="2、Dubbo服务端"></a>2、Dubbo服务端</h4><p><img src="https://i.imgur.com/SBm6dvs.png" alt=""></p>
<h4 id="3、配置原则"><a href="#3、配置原则" class="headerlink" title="3、配置原则"></a>3、配置原则</h4><ul>
<li>dubbo推荐在Provider上尽量多配置Consumer端属性：</li>
</ul>
<p><img src="https://i.imgur.com/9sYbjet.png" alt=""></p>
<p>配置的覆盖规则：</p>
<p>1) 方法级配置别优于接口级别，即小Scope优先 </p>
<p>2) Consumer端配置 优于 Provider配置 优于 全局配置</p>
<p>3) 最后是Dubbo Hard Code的配置值（见配置文档）</p>
<p><img src="https://i.imgur.com/d1tPI3m.png" alt=""></p>
<h3 id="版本号"><a href="#版本号" class="headerlink" title="版本号"></a>版本号</h3><ul>
<li>当一个接口实现，出现不兼容升级时，可以用版本号过渡，版本号不同的服务相互间不引用。<br>可以按照以下的步骤进行版本迁移：</li>
</ul>
<p>1、在低压力时间段，先升级一半提供者为新版本</p>
<p>2、再将所有消费者升级为新版本</p>
<p>3、然后将剩下的一半提供者升级为新版本</p>
<p><img src="https://i.imgur.com/meGpOyY.png" alt=""><br><img src="https://i.imgur.com/0cDzlpZ.png" alt=""></p>
<h2 id="高可用"><a href="#高可用" class="headerlink" title="高可用"></a>高可用</h2><h3 id="1、zookeeper宕机与dubbo直连"><a href="#1、zookeeper宕机与dubbo直连" class="headerlink" title="1、zookeeper宕机与dubbo直连"></a>1、zookeeper宕机与dubbo直连</h3><ul>
<li><p>现象：zookeeper注册中心宕机，还可以消费dubbo暴露的服务。</p>
</li>
<li><p>原因：</p>
</li>
</ul>
<p>健壮性：</p>
<ul>
<li>监控中心宕掉不影响使用，只是丢失部分采样数据</li>
<li>数据库宕掉后，注册中心仍能通过缓存提供服务列表查询，但不能注册新服务</li>
<li>注册中心对等集群，任意一台宕掉后，将自动切换到另一台</li>
<li>注册中心全部宕掉后，服务提供者和服务消费者仍能通过本地缓存通讯</li>
<li>服务提供者无状态，任意一台宕掉后，不影响使用</li>
<li>服务提供者全部宕掉后，服务消费者应用将无法使用，并无限次重连等待服务提供者恢复</li>
</ul>
<p>高可用：通过设计，减少系统不能提供服务的时间</p>
<h3 id="2、集群下dubbo负载均衡配置"><a href="#2、集群下dubbo负载均衡配置" class="headerlink" title="2、集群下dubbo负载均衡配置"></a>2、集群下dubbo负载均衡配置</h3><ul>
<li>在集群负载均衡时，Dubbo 提供了多种均衡策略，缺省为 random 随机调用。</li>
</ul>
<h4 id="负载均衡策略"><a href="#负载均衡策略" class="headerlink" title="负载均衡策略"></a>负载均衡策略</h4><p>Random LoadBalance</p>
<ul>
<li>随机，按权重设置随机概率。<br>在一个截面上碰撞的概率高，但调用量越大分布越均匀，而且按概率使用权重后也比较均匀，有利于动态调整提供者权重。</li>
</ul>
<p>RoundRobin LoadBalance</p>
<ul>
<li>轮循，按公约后的权重设置轮循比率。<br>存在慢的提供者累积请求的问题，比如：第二台机器很慢，但没挂，当请求调到第二台时就卡在那，久而久之，所有请求都卡在调到第二台上。</li>
</ul>
<p>LeastActive LoadBalance</p>
<ul>
<li>最少活跃调用数，相同活跃数的随机，活跃数指调用前后计数差。<br>使慢的提供者收到更少请求，因为越慢的提供者的调用前后计数差会越大。</li>
</ul>
<p>ConsistentHash LoadBalance</p>
<ul>
<li>一致性 Hash，相同参数的请求总是发到同一提供者。<br>当某一台提供者挂时，原本发往该提供者的请求，基于虚拟节点，平摊到其它提供者，不会引起剧烈变动。算法参见：<a href="http://en.wikipedia.org/wiki/Consistent_hashing" target="_blank" rel="noopener">http://en.wikipedia.org/wiki/Consistent_hashing</a><br>缺省只对第一个参数 Hash，如果要修改，请配置 &lt;dubbo:parameter key=”hash.arguments” value=”0,1” /&gt;<br>缺省用 160 份虚拟节点，如果要修改，请配置 &lt;dubbo:parameter key=”hash.nodes” value=”320” /&gt;</li>
</ul>
<h3 id="3、整合hystrix，服务熔断与降级处理"><a href="#3、整合hystrix，服务熔断与降级处理" class="headerlink" title="3、整合hystrix，服务熔断与降级处理"></a>3、整合hystrix，服务熔断与降级处理</h3><h4 id="服务降级"><a href="#服务降级" class="headerlink" title="服务降级"></a>服务降级</h4><ul>
<li>当服务器压力剧增的情况下，根据实际业务情况及流量，对一些服务和页面有策略的不处理或换种简单的方式处理，从而释放服务器资源以保证核心交易正常运作或高效运作。</li>
<li>可以通过服务降级功能临时屏蔽某个出错的非关键服务，并定义降级后的返回策略。</li>
<li><p>向注册中心写入动态配置覆盖规则：</p>
<p>  RegistryFactory registryFactory = ExtensionLoader.getExtensionLoader(RegistryFactory.class).getAdaptiveExtension();<br>  Registry registry = registryFactory.getRegistry(URL.valueOf(“zookeeper://10.20.153.10:2181”));<br>  registry.register(URL.valueOf(“override://0.0.0.0/com.foo.BarService?category=configurators&amp;dynamic=false&amp;application=foo&amp;mock=force:return+null”));</p>
</li>
<li><p>其中：</p>
</li>
<li><p>mock=force:return+null 表示消费方对该服务的方法调用都直接返回 null 值，不发起远程调用。用来屏蔽不重要服务不可用时对调用方的影响。</p>
</li>
<li>还可以改为 mock=fail:return+null 表示消费方对该服务的方法调用在失败后，再返回 null 值，不抛异常。用来容忍不重要服务不稳定时对调用方的影响。</li>
</ul>
<h4 id="集群容错"><a href="#集群容错" class="headerlink" title="集群容错"></a>集群容错</h4><ul>
<li>在集群调用失败时，Dubbo 提供了多种容错方案，缺省为 failover 重试。<h5 id="集群容错模式"><a href="#集群容错模式" class="headerlink" title="集群容错模式"></a>集群容错模式</h5></li>
</ul>
<p>Failover Cluster</p>
<ul>
<li><p>失败自动切换，当出现失败，重试其它服务器。通常用于读操作，但重试会带来更长延迟。可通过 retries=”2” 来设置重试次数(不含第一次)。</p>
</li>
<li><p>重试次数配置如下：</p>
</li>
<li>&lt;dubbo:service retries=”2” /&gt;<br>或<br>&lt;dubbo:reference retries=”2” /&gt;<br>或<br><a href="dubbo:reference" target="_blank" rel="noopener">dubbo:reference</a><br>  &lt;dubbo:method name=”findFoo” retries=”2” /&gt;<br>&lt;/dubbo:reference&gt;</li>
</ul>
<p>Failfast Cluster</p>
<ul>
<li>快速失败，只发起一次调用，失败立即报错。通常用于非幂等性的写操作，比如新增记录。</li>
</ul>
<p>Failsafe Cluster</p>
<ul>
<li>失败安全，出现异常时，直接忽略。通常用于写入审计日志等操作。</li>
</ul>
<p>Failback Cluster</p>
<ul>
<li>失败自动恢复，后台记录失败请求，定时重发。通常用于消息通知操作。</li>
</ul>
<p>Forking Cluster</p>
<ul>
<li>并行调用多个服务器，只要一个成功即返回。通常用于实时性要求较高的读操作，但需要浪费更多服务资源。可通过 forks=”2” 来设置最大并行数。</li>
</ul>
<p>Broadcast Cluster</p>
<ul>
<li>广播调用所有提供者，逐个调用，任意一台报错则报错 [2]。通常用于通知所有提供者更新缓存或日志等本地资源信息。</li>
</ul>
<p>集群模式配置</p>
<ul>
<li>按照以下示例在服务提供方和消费方配置集群模式<br>&lt;dubbo:service cluster=”failsafe” /&gt;<br>或<br>&lt;dubbo:reference cluster=”failsafe” /&gt;</li>
</ul>
<h4 id="整合hystrix"><a href="#整合hystrix" class="headerlink" title="整合hystrix"></a>整合hystrix</h4><ul>
<li>Hystrix 旨在通过控制那些访问远程系统、服务和第三方库的节点，从而对延迟和故障提供更强大的容错能力。Hystrix具备拥有回退机制和断路器功能的线程和信号隔离，请求缓存和请求打包，以及监控和配置等功能</li>
</ul>
<h5 id="1、配置spring-cloud-starter-netflix-hystrix"><a href="#1、配置spring-cloud-starter-netflix-hystrix" class="headerlink" title="1、配置spring-cloud-starter-netflix-hystrix"></a>1、配置spring-cloud-starter-netflix-hystrix</h5><ul>
<li>spring boot官方提供了对hystrix的集成，直接在pom.xml里加入依赖：</li>
</ul>
<p><img src="https://i.imgur.com/dYHEYur.png" alt=""></p>
<ul>
<li>然后在Application类上增加@EnableHystrix来启用hystrix starter：</li>
</ul>
<p><img src="https://i.imgur.com/UyTluWr.png" alt=""></p>
<h5 id="2、配置Provider端"><a href="#2、配置Provider端" class="headerlink" title="2、配置Provider端"></a>2、配置Provider端</h5><ul>
<li><p>在Dubbo的Provider上增加@HystrixCommand配置，这样子调用就会经过Hystrix代理。</p>
<pre><code>@Service(version = &quot;1.0.0&quot;)
public class HelloServiceImpl implements HelloService {
    @HystrixCommand(commandProperties = {
     @HystrixProperty(name = &quot;circuitBreaker.requestVolumeThreshold&quot;, value = &quot;10&quot;),
     @HystrixProperty(name = &quot;execution.isolation.thread.timeoutInMilliseconds&quot;, value = &quot;2000&quot;) })
    @Override
    public String sayHello(String name) {
        // System.out.println(&quot;async provider received: &quot; + name);
        // return &quot;annotation: hello, &quot; + name;
        throw new RuntimeException(&quot;Exception to show hystrix enabled.&quot;);
    }
}
</code></pre></li>
</ul>
<h5 id="3、配置Consumer端"><a href="#3、配置Consumer端" class="headerlink" title="3、配置Consumer端"></a>3、配置Consumer端</h5><ul>
<li><p>对于Consumer端，则可以增加一层method调用，并在method上配置@HystrixCommand。当调用出错时，会走到fallbackMethod = “reliable”的调用里。</p>
<pre><code>@Reference(version = &quot;1.0.0&quot;)
  private HelloService demoService;

  @HystrixCommand(fallbackMethod = &quot;reliable&quot;)
  public String doSayHello(String name) {
      return demoService.sayHello(name);
  }
  public String reliable(String name) {
      return &quot;hystrix fallback value&quot;;
  }
</code></pre></li>
</ul>
<h2 id="Dubbo原理"><a href="#Dubbo原理" class="headerlink" title="Dubbo原理"></a>Dubbo原理</h2><h3 id="1、RPC原理"><a href="#1、RPC原理" class="headerlink" title="1、RPC原理"></a>1、RPC原理</h3><p><img src="https://i.imgur.com/XwqpFp9.png" alt=""></p>
<ul>
<li>一次完整的RPC调用流程（同步调用，异步另说）如下： </li>
</ul>
<p>1）服务消费方（client）调用以本地调用方式调用服务；</p>
<p>2）client stub接收到调用后负责将方法、参数等组装成能够进行网络传输的消息体；</p>
<p>3）client stub找到服务地址，并将消息发送到服务端； </p>
<p>4）server stub收到消息后进行解码； </p>
<p>5）server stub根据解码结果调用本地的服务； </p>
<p>6）本地服务执行并将结果返回给server stub； </p>
<p>7）server stub将返回结果打包成消息并发送至消费方； </p>
<p>8）client stub接收到消息，并进行解码； </p>
<p>9）服务消费方得到最终结果。</p>
<ul>
<li>RPC框架的目标就是要2~8这些步骤都封装起来，这些细节对用户来说是透明的，不可见的。</li>
</ul>
<h3 id="2、netty通信原理"><a href="#2、netty通信原理" class="headerlink" title="2、netty通信原理"></a>2、netty通信原理</h3><ul>
<li>Netty是一个异步事件驱动的网络应用程序框架， 用于快速开发可维护的高性能协议服务器和客户端。它极大地简化并简化了TCP和UDP套接字服务器等网络编程。</li>
</ul>
<h4 id="BIO：-Blocking-IO"><a href="#BIO：-Blocking-IO" class="headerlink" title="BIO：(Blocking IO)"></a>BIO：(Blocking IO)</h4><p><img src="https://i.imgur.com/OoJriEb.png" alt=""></p>
<h4 id="NIO-Non-Blocking-IO"><a href="#NIO-Non-Blocking-IO" class="headerlink" title="NIO (Non-Blocking IO)"></a>NIO (Non-Blocking IO)</h4><p><img src="https://i.imgur.com/EDrrPes.png" alt=""></p>
<ul>
<li>Selector 一般称 为选择器 ，也可以翻译为 多路复用器，</li>
<li>Connect（连接就绪）、Accept（接受就绪）、Read（读就绪）、Write（写就绪）</li>
</ul>
<h4 id="Netty基本原理："><a href="#Netty基本原理：" class="headerlink" title="Netty基本原理："></a>Netty基本原理：</h4><p><img src="https://i.imgur.com/yMwo7Bc.png" alt=""></p>
<h3 id="3、dubbo原理"><a href="#3、dubbo原理" class="headerlink" title="3、dubbo原理"></a>3、dubbo原理</h3><h4 id="1、dubbo原理-框架设计"><a href="#1、dubbo原理-框架设计" class="headerlink" title="1、dubbo原理-框架设计"></a>1、dubbo原理-框架设计</h4><p><img src="https://i.imgur.com/9p9sFVH.png" alt=""></p>
<ul>
<li>config 配置层：对外配置接口，以 ServiceConfig, ReferenceConfig 为中心，可以直接初始化配置类，也可以通过 spring 解析配置生成配置类</li>
<li>proxy 服务代理层：服务接口透明代理，生成服务的客户端 Stub 和服务器端 Skeleton, 以 ServiceProxy 为中心，扩展接口为 ProxyFactory</li>
<li>registry 注册中心层：封装服务地址的注册与发现，以服务 URL 为中心，扩展接口为 RegistryFactory, Registry, RegistryService</li>
<li>cluster 路由层：封装多个提供者的路由及负载均衡，并桥接注册中心，以 Invoker 为中心，扩展接口为 Cluster, Directory, Router, LoadBalance</li>
<li>monitor 监控层：RPC 调用次数和调用时间监控，以 Statistics 为中心，扩展接口为 MonitorFactory, Monitor, MonitorService</li>
<li>protocol 远程调用层：封装 RPC 调用，以 Invocation, Result 为中心，扩展接口为 Protocol, Invoker, Exporter</li>
<li>exchange 信息交换层：封装请求响应模式，同步转异步，以 Request, Response 为中心，扩展接口为 Exchanger, ExchangeChannel, ExchangeClient, ExchangeServer</li>
<li>transport 网络传输层：抽象 mina 和 netty 为统一接口，以 Message 为中心，扩展接口为 Channel, Transporter, Client, Server, Codec</li>
<li>serialize 数据序列化层：可复用的一些工具，扩展接口为 Serialization, ObjectInput, ObjectOutput, ThreadPool</li>
</ul>
<h4 id="2、dubbo原理-启动解析、加载配置信息"><a href="#2、dubbo原理-启动解析、加载配置信息" class="headerlink" title="2、dubbo原理-启动解析、加载配置信息"></a>2、dubbo原理-启动解析、加载配置信息</h4><p><img src="https://i.imgur.com/Z1omkkw.png" alt=""></p>
<h4 id="3、dubbo原理-服务暴露"><a href="#3、dubbo原理-服务暴露" class="headerlink" title="3、dubbo原理-服务暴露"></a>3、dubbo原理-服务暴露</h4><p><img src="https://i.imgur.com/rt3YVYn.png" alt=""></p>
<h4 id="4、dubbo原理-服务引用"><a href="#4、dubbo原理-服务引用" class="headerlink" title="4、dubbo原理-服务引用"></a>4、dubbo原理-服务引用</h4><p><img src="https://i.imgur.com/1daJBV5.png" alt=""></p>
<h4 id="5、dubbo原理-服务调用"><a href="#5、dubbo原理-服务调用" class="headerlink" title="5、dubbo原理-服务调用"></a>5、dubbo原理-服务调用</h4><p><img src="https://i.imgur.com/nDqoHe1.png" alt=""></p>

      
    </div>
	<div>
  
    <div>
    
        <div style="text-align:center;color: #ccc;font-size:14px;">-------------本文结束<i class="fa fa-paw"></i>感谢您的阅读-------------</div>
    
</div>


  
</div>
    
    
    

    

    

    

    <footer class="post-footer">
      
        <div class="post-tags">
          
            <a href="/tags/dubbo/" rel="tag"># dubbo</a>
          
        </div>
      

      
      
      

      
        <div class="post-nav">
          <div class="post-nav-next post-nav-item">
            
              <a href="/2018/10/08/ajax学习笔记/" rel="next" title="ajax学习笔记">
                <i class="fa fa-chevron-left"></i> ajax学习笔记
              </a>
            
          </div>

          <span class="post-nav-divider"></span>

          <div class="post-nav-prev post-nav-item">
            
          </div>
        </div>
      

      
      
    </footer>
  </div>
  
  
  
  </article>



    <div class="post-spread">
      
    </div>
  </div>


          </div>
          


          
  <div class="comments" id="comments">
    
  </div>


        </div>
        
          
  
  <div class="sidebar-toggle">
    <div class="sidebar-toggle-line-wrap">
      <span class="sidebar-toggle-line sidebar-toggle-line-first"></span>
      <span class="sidebar-toggle-line sidebar-toggle-line-middle"></span>
      <span class="sidebar-toggle-line sidebar-toggle-line-last"></span>
    </div>
  </div>

  <aside id="sidebar" class="sidebar">
    
    <div class="sidebar-inner">

      

      
        <ul class="sidebar-nav motion-element">
          <li class="sidebar-nav-toc sidebar-nav-active" data-target="post-toc-wrap" >
            文章目录
          </li>
          <li class="sidebar-nav-overview" data-target="site-overview">
            站点概览
          </li>
        </ul>
      

      <section class="site-overview sidebar-panel">
        <div class="site-author motion-element" itemprop="author" itemscope itemtype="http://schema.org/Person">
          <img class="site-author-image" itemprop="image"
               src="/uploads/avatar.jpg"
               alt="inu" />
          <p class="site-author-name" itemprop="name">inu</p>
           
              <p class="site-description motion-element" itemprop="description">有一种鸟儿是注定无法被囚禁的，因为它们的每一片羽翼都闪耀着自由的光辉 --《肖申克的救赎》</p>
          
        </div>
        <nav class="site-state motion-element">

          
            <div class="site-state-item site-state-posts">
              <a href="/archives">
                <span class="site-state-item-count">3</span>
                <span class="site-state-item-name">日志</span>
              </a>
            </div>
          

          
            
            
            <div class="site-state-item site-state-categories">
              
                <span class="site-state-item-count">1</span>
                <span class="site-state-item-name">分类</span>
              
            </div>
          

          
            
            
            <div class="site-state-item site-state-tags">
              <a href="/tags/index.html">
                <span class="site-state-item-count">3</span>
                <span class="site-state-item-name">标签</span>
              </a>
            </div>
          

        </nav>

        

        <div class="links-of-author motion-element">
          
        </div>

        
        

        
        

        


      </section>

      
      <!--noindex-->
        <section class="post-toc-wrap motion-element sidebar-panel sidebar-panel-active">
          <div class="post-toc">

            
              
            

            
              <div class="post-toc-content"><ol class="nav"><li class="nav-item nav-level-1"><a class="nav-link" href="#Dubbo框架学习"><span class="nav-number">1.</span> <span class="nav-text">Dubbo框架学习</span></a><ol class="nav-child"><li class="nav-item nav-level-2"><a class="nav-link" href="#概念"><span class="nav-number">1.1.</span> <span class="nav-text">概念</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#发展演变"><span class="nav-number">1.2.</span> <span class="nav-text">发展演变</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#单一应用架构"><span class="nav-number">1.2.1.</span> <span class="nav-text">单一应用架构</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#垂直应用架构"><span class="nav-number">1.2.2.</span> <span class="nav-text">垂直应用架构</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#分布式服务架构"><span class="nav-number">1.2.3.</span> <span class="nav-text">分布式服务架构</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#流动计算架构"><span class="nav-number">1.2.4.</span> <span class="nav-text">流动计算架构</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#RPC"><span class="nav-number">1.3.</span> <span class="nav-text">RPC</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#基本原理"><span class="nav-number">1.3.1.</span> <span class="nav-text">基本原理</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#Dubbo核心概念"><span class="nav-number">1.4.</span> <span class="nav-text">Dubbo核心概念</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#简介"><span class="nav-number">1.4.1.</span> <span class="nav-text">简介</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#基本概念"><span class="nav-number">1.4.2.</span> <span class="nav-text">基本概念</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#调用关系说明："><span class="nav-number">1.4.2.1.</span> <span class="nav-text">调用关系说明：</span></a></li></ol></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#dubbo环境搭建"><span class="nav-number">1.5.</span> <span class="nav-text">dubbo环境搭建</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#windows下安装zookeeper"><span class="nav-number">1.5.1.</span> <span class="nav-text">windows下安装zookeeper</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#Windows安装dubbo-admin管理控制台"><span class="nav-number">1.5.2.</span> <span class="nav-text">Windows安装dubbo-admin管理控制台</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#dubbo项目实例"><span class="nav-number">1.6.</span> <span class="nav-text">dubbo项目实例</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#提出需求"><span class="nav-number">1.6.1.</span> <span class="nav-text">提出需求</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#工程架构"><span class="nav-number">1.6.2.</span> <span class="nav-text">工程架构</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#分包"><span class="nav-number">1.6.2.1.</span> <span class="nav-text">分包</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#粒度"><span class="nav-number">1.6.2.2.</span> <span class="nav-text">粒度</span></a></li></ol></li><li class="nav-item nav-level-3"><a class="nav-link" href="#创建模块"><span class="nav-number">1.6.3.</span> <span class="nav-text">创建模块</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#1、gmall-interface：公共接口层（model，service，exception…）"><span class="nav-number">1.6.3.1.</span> <span class="nav-text">1、gmall-interface：公共接口层（model，service，exception…）</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#2、gmall-user：用户模块（对用户接口的实现）"><span class="nav-number">1.6.3.2.</span> <span class="nav-text">2、gmall-user：用户模块（对用户接口的实现）</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#3、gmall-order-web：订单模块（调用用户模块）"><span class="nav-number">1.6.3.3.</span> <span class="nav-text">3、gmall-order-web：订单模块（调用用户模块）</span></a></li></ol></li><li class="nav-item nav-level-3"><a class="nav-link" href="#使用dubbo改造"><span class="nav-number">1.6.4.</span> <span class="nav-text">使用dubbo改造</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#1、改造gmall-user作为服务提供者"><span class="nav-number">1.6.4.1.</span> <span class="nav-text">1、改造gmall-user作为服务提供者</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#2、改造gmall-order-web作为服务消费者"><span class="nav-number">1.6.4.2.</span> <span class="nav-text">2、改造gmall-order-web作为服务消费者</span></a></li></ol></li><li class="nav-item nav-level-3"><a class="nav-link" href="#3、测试调用"><span class="nav-number">1.6.5.</span> <span class="nav-text">3、测试调用</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#4、注解版"><span class="nav-number">1.6.6.</span> <span class="nav-text">4、注解版</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#监控中心"><span class="nav-number">1.7.</span> <span class="nav-text">监控中心</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#dubbo-admin"><span class="nav-number">1.7.1.</span> <span class="nav-text">dubbo-admin</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#dubbo-monitor-simple"><span class="nav-number">1.7.2.</span> <span class="nav-text">dubbo-monitor-simple</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#1、安装"><span class="nav-number">1.7.2.1.</span> <span class="nav-text">1、安装</span></a></li></ol></li><li class="nav-item nav-level-3"><a class="nav-link" href="#监控中心配置"><span class="nav-number">1.7.3.</span> <span class="nav-text">监控中心配置</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#整合SpringBoot"><span class="nav-number">1.8.</span> <span class="nav-text">整合SpringBoot</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#1、引入spring-boot-starter以及dubbo和curator的依赖"><span class="nav-number">1.8.1.</span> <span class="nav-text">1、引入spring-boot-starter以及dubbo和curator的依赖</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#2、配置application-properties"><span class="nav-number">1.8.2.</span> <span class="nav-text">2、配置application.properties</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#dubbo配置"><span class="nav-number">1.9.</span> <span class="nav-text">dubbo配置</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#配置原则"><span class="nav-number">1.9.1.</span> <span class="nav-text">配置原则</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#重试次数"><span class="nav-number">1.9.2.</span> <span class="nav-text">重试次数</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#超时时间"><span class="nav-number">1.9.3.</span> <span class="nav-text">超时时间</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#1、Dubbo消费端"><span class="nav-number">1.9.3.1.</span> <span class="nav-text">1、Dubbo消费端</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#2、Dubbo服务端"><span class="nav-number">1.9.3.2.</span> <span class="nav-text">2、Dubbo服务端</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#3、配置原则"><span class="nav-number">1.9.3.3.</span> <span class="nav-text">3、配置原则</span></a></li></ol></li><li class="nav-item nav-level-3"><a class="nav-link" href="#版本号"><span class="nav-number">1.9.4.</span> <span class="nav-text">版本号</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#高可用"><span class="nav-number">1.10.</span> <span class="nav-text">高可用</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#1、zookeeper宕机与dubbo直连"><span class="nav-number">1.10.1.</span> <span class="nav-text">1、zookeeper宕机与dubbo直连</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#2、集群下dubbo负载均衡配置"><span class="nav-number">1.10.2.</span> <span class="nav-text">2、集群下dubbo负载均衡配置</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#负载均衡策略"><span class="nav-number">1.10.2.1.</span> <span class="nav-text">负载均衡策略</span></a></li></ol></li><li class="nav-item nav-level-3"><a class="nav-link" href="#3、整合hystrix，服务熔断与降级处理"><span class="nav-number">1.10.3.</span> <span class="nav-text">3、整合hystrix，服务熔断与降级处理</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#服务降级"><span class="nav-number">1.10.3.1.</span> <span class="nav-text">服务降级</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#集群容错"><span class="nav-number">1.10.3.2.</span> <span class="nav-text">集群容错</span></a><ol class="nav-child"><li class="nav-item nav-level-5"><a class="nav-link" href="#集群容错模式"><span class="nav-number">1.10.3.2.1.</span> <span class="nav-text">集群容错模式</span></a></li></ol></li><li class="nav-item nav-level-4"><a class="nav-link" href="#整合hystrix"><span class="nav-number">1.10.3.3.</span> <span class="nav-text">整合hystrix</span></a><ol class="nav-child"><li class="nav-item nav-level-5"><a class="nav-link" href="#1、配置spring-cloud-starter-netflix-hystrix"><span class="nav-number">1.10.3.3.1.</span> <span class="nav-text">1、配置spring-cloud-starter-netflix-hystrix</span></a></li><li class="nav-item nav-level-5"><a class="nav-link" href="#2、配置Provider端"><span class="nav-number">1.10.3.3.2.</span> <span class="nav-text">2、配置Provider端</span></a></li><li class="nav-item nav-level-5"><a class="nav-link" href="#3、配置Consumer端"><span class="nav-number">1.10.3.3.3.</span> <span class="nav-text">3、配置Consumer端</span></a></li></ol></li></ol></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#Dubbo原理"><span class="nav-number">1.11.</span> <span class="nav-text">Dubbo原理</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#1、RPC原理"><span class="nav-number">1.11.1.</span> <span class="nav-text">1、RPC原理</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#2、netty通信原理"><span class="nav-number">1.11.2.</span> <span class="nav-text">2、netty通信原理</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#BIO：-Blocking-IO"><span class="nav-number">1.11.2.1.</span> <span class="nav-text">BIO：(Blocking IO)</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#NIO-Non-Blocking-IO"><span class="nav-number">1.11.2.2.</span> <span class="nav-text">NIO (Non-Blocking IO)</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#Netty基本原理："><span class="nav-number">1.11.2.3.</span> <span class="nav-text">Netty基本原理：</span></a></li></ol></li><li class="nav-item nav-level-3"><a class="nav-link" href="#3、dubbo原理"><span class="nav-number">1.11.3.</span> <span class="nav-text">3、dubbo原理</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#1、dubbo原理-框架设计"><span class="nav-number">1.11.3.1.</span> <span class="nav-text">1、dubbo原理-框架设计</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#2、dubbo原理-启动解析、加载配置信息"><span class="nav-number">1.11.3.2.</span> <span class="nav-text">2、dubbo原理-启动解析、加载配置信息</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#3、dubbo原理-服务暴露"><span class="nav-number">1.11.3.3.</span> <span class="nav-text">3、dubbo原理-服务暴露</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#4、dubbo原理-服务引用"><span class="nav-number">1.11.3.4.</span> <span class="nav-text">4、dubbo原理-服务引用</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#5、dubbo原理-服务调用"><span class="nav-number">1.11.3.5.</span> <span class="nav-text">5、dubbo原理-服务调用</span></a></li></ol></li></ol></li></ol></li></ol></div>
            

          </div>
        </section>
      <!--/noindex-->
      

      

    </div>
  </aside>


        
      </div>
    </main>

    <footer id="footer" class="footer">
      <div class="footer-inner">
        <script async src="https://dn-lbstatics.qbox.me/busuanzi/2.3/busuanzi.pure.mini.js"></script>
<div class="copyright" >
  
  &copy; 
  <span itemprop="copyrightYear">2018</span>
  <span class="with-love">
    <i class="fa fa-heart"></i>
  </span>
  <span class="author" itemprop="copyrightHolder">inu</span>
</div>


<div class="powered-by">
<i class="fa fa-user-md"></i><span id="busuanzi_container_site_uv">
  本站总访问量<span id="busuanzi_value_site_uv"></span>次
</span>
</div>

<!--<div class="powered-by">
  由 <a class="theme-link" href="https://hexo.io">Hexo</a> 强力驱动
</div>

<div class="theme-info">
  主题 -
  <a class="theme-link" href="https://github.com/iissnan/hexo-theme-next">
    NexT.Pisces
  </a>
</div>
-->


        

        
      </div>
    </footer>

    
      <div class="back-to-top">
        <i class="fa fa-arrow-up"></i>
        
      </div>
    

  </div>

  

<script type="text/javascript">
  if (Object.prototype.toString.call(window.Promise) !== '[object Function]') {
    window.Promise = null;
  }
</script>









  


  











  
  <script type="text/javascript" src="/lib/jquery/index.js?v=2.1.3"></script>

  
  <script type="text/javascript" src="/lib/fastclick/lib/fastclick.min.js?v=1.0.6"></script>

  
  <script type="text/javascript" src="/lib/jquery_lazyload/jquery.lazyload.js?v=1.9.7"></script>

  
  <script type="text/javascript" src="/lib/velocity/velocity.min.js?v=1.2.1"></script>

  
  <script type="text/javascript" src="/lib/velocity/velocity.ui.min.js?v=1.2.1"></script>

  
  <script type="text/javascript" src="/lib/fancybox/source/jquery.fancybox.pack.js?v=2.1.5"></script>

  
  <script type="text/javascript" src="/lib/canvas-nest/canvas-nest.min.js"></script>


  


  <script type="text/javascript" src="/js/src/utils.js?v=5.1.2"></script>

  <script type="text/javascript" src="/js/src/motion.js?v=5.1.2"></script>



  
  


  <script type="text/javascript" src="/js/src/affix.js?v=5.1.2"></script>

  <script type="text/javascript" src="/js/src/schemes/pisces.js?v=5.1.2"></script>



  
  <script type="text/javascript" src="/js/src/scrollspy.js?v=5.1.2"></script>
<script type="text/javascript" src="/js/src/post-details.js?v=5.1.2"></script>



  


  <script type="text/javascript" src="/js/src/bootstrap.js?v=5.1.2"></script>



  


  




	





  





  






  





  

  

  

  

  

  

  
<script type="text/javascript" src="//cdn.bootcss.com/canvas-nest.js/1.0.0/canvas-nest.min.js"></script>
<!-- 页面点击小红心 -->
<script type="text/javascript" src="/js/src/love.js"></script>
<script src="/live2dw/lib/L2Dwidget.min.js?0c58a1486de42ac6cc1c59c7d98ae887"></script><script>L2Dwidget.init({"model":{"scale":0.75,"hHeadPos":0.5,"vHeadPos":0.618},"display":{"superSample":2,"width":150,"height":300,"position":"right","hOffset":0,"vOffset":-20},"mobile":{"show":true,"scale":0.5},"react":{"opacityDefault":0.7,"opacityOnHover":0.2},"log":false,"pluginJsPath":"lib/","pluginModelPath":"assets/","pluginRootPath":"live2dw/","tagMode":false});</script></body>
</html>

